<?xml version="1.0" encoding="UTF-8" standalone="no"?><beast beautiplate='snapper' beautistatus='' namespace="beast.core:beast.evolution.alignment:beast.evolution.tree.coalescent:beast.core.util:beast.evolution.nuc:beast.evolution.operators:beast.evolution.sitemodel:beast.evolution.substitutionmodel:beast.evolution.likelihood" required="" version="2.6">

    <data
id="snapper"
spec="Alignment"
dataType="integer"
name="rawdata">
<sequence spec='Sequence' taxon='A_1' totalcount='2' value='1100010010110111010011110110000000011100010110101010001110111001010101011010001011110111010110101011'/>
<sequence spec='Sequence' taxon='A_2' totalcount='2' value='0110001000111101011110111101111111011011111100001011000110011101010101011000101001100100110010101110'/>
<sequence spec='Sequence' taxon='A_3' totalcount='2' value='1110010011110111011001110100011110111001110010001111101100011111011110101011101000100110010110111101'/>
<sequence spec='Sequence' taxon='A_4' totalcount='2' value='1010001000111110001011000001100000011001111101000110010110010001010111101000111100100100100111101011'/>
<sequence spec='Sequence' taxon='B_1' totalcount='2' value='0011011111100011111000111101100000010001111010000011110010010101110001001110000001010001100111101111'/>
<sequence spec='Sequence' taxon='B_2' totalcount='2' value='1011111111011111111010000010011111111011111010000101111100111111110011110101010011100100110001011001'/>
<sequence spec='Sequence' taxon='B_3' totalcount='2' value='0110000011001111111000011111110011110111011111001110011010110101010001001110010001111001011110010011'/>
<sequence spec='Sequence' taxon='B_4' totalcount='2' value='0111000101100101001001110110110110101010101010001110100010010111001010000101110001111101100010011100'/>
<sequence spec='Sequence' taxon='C_1' totalcount='2' value='0000001101110101011010100000010111100011011001101110101100001111111111110000110100101110010010100000'/>
<sequence spec='Sequence' taxon='C_2' totalcount='2' value='0111101111101011011011100100101000101011000101001101100010010111110100100001101110111110000100111110'/>
<sequence spec='Sequence' taxon='C_3' totalcount='2' value='1111101010111011110011001110100101110011111010001100110011001011101011110100111110110110111001100111'/>
<sequence spec='Sequence' taxon='C_4' totalcount='2' value='0111000110010111010010101111101000010011101001101001110001100111110101100000100100111110101010010111'/>
<sequence spec='Sequence' taxon='D_1' totalcount='2' value='0011110110010111000000010111010100011000010110110001101110110110101110000011000110001110110110100101'/>
<sequence spec='Sequence' taxon='D_2' totalcount='2' value='0010010101100001011000000101110110111110011000100000101111110101101011111000111100010110110011010111'/>
<sequence spec='Sequence' taxon='D_3' totalcount='2' value='0010100000110011001010010110011111101100000001001000001100100101110101010011100010111010110010111101'/>
<sequence spec='Sequence' taxon='D_4' totalcount='2' value='0010110110111011000010110110110110111010011000101101011110100110111001000001111101101110110011101110'/>
<sequence spec='Sequence' taxon='E_1' totalcount='2' value='1110000110000001001011001110101000000100011110001111101110010011111011100010000000101100110100101100'/>
<sequence spec='Sequence' taxon='E_2' totalcount='2' value='1011110010101100100100010101111111100001101010000111100110111001111010101110011010101100000100001110'/>
<sequence spec='Sequence' taxon='E_3' totalcount='2' value='0010101110000000001001110110111101000001100100101111101101101011111011101110010000001000101100110100'/>
<sequence spec='Sequence' taxon='E_4' totalcount='2' value='1010000111011101001100010010001111100100111000001110000011010001101001010110110000001111001010000110'/>
<sequence spec='Sequence' taxon='F_1' totalcount='2' value='1001110010001000100011010001110111011001011110010110111100010101001101000010101100001101010100011110'/>
<sequence spec='Sequence' taxon='F_2' totalcount='2' value='1001010110010100001100010100001101000100001110011101100101010001111011101010111110111100110110001000'/>
<sequence spec='Sequence' taxon='F_3' totalcount='2' value='1011000110111110101111111100101110001001000111101011100101010101101001010010010000111110111010011110'/>
<sequence spec='Sequence' taxon='F_4' totalcount='2' value='0001110101100100101110011001111100001100111100111111110100010111100001001010100000001101101000001110'/>
<sequence spec='Sequence' taxon='G_1' totalcount='2' value='1010011111110110110000010011101010010011011111100101011100101000100010001001011111100101110110000011'/>
<sequence spec='Sequence' taxon='G_2' totalcount='2' value='0011100001000111110000000011111011111011011111001001110100010101000001001111101111111101000001011000'/>
<sequence spec='Sequence' taxon='G_3' totalcount='2' value='0111000111111110111100110000101010011011111111100001011000010110111101000100101001100011100101101011'/>
<sequence spec='Sequence' taxon='G_4' totalcount='2' value='1011101001111011111001101110100110111111000010101110110100111101110001101111010111110101100011100111'/>
<sequence spec='Sequence' taxon='H_1' totalcount='2' value='0100011001110111110000100110111000110101011001000110010111010000111000100011110010111111101111000010'/>
<sequence spec='Sequence' taxon='H_2' totalcount='2' value='1110010000101111100100100010111110111011001000011100110100010100110001010001110010110101111001000011'/>
<sequence spec='Sequence' taxon='H_3' totalcount='2' value='0110110010101111000010100110111110010101100100011101010110000000111000010001100000110110110110000110'/>
<sequence spec='Sequence' taxon='H_4' totalcount='2' value='1110001000000101100001101111011010011011010100001100010100011000100001110011100010110111000010000110'/>
<sequence spec='Sequence' taxon='I_1' totalcount='2' value='1111010010100101011110101010100010001001011011000110101110011101101110111110011001101100110001101110'/>
<sequence spec='Sequence' taxon='I_2' totalcount='2' value='0100011100110111000011101011101110100111101011011101010100110000111010111111101010101010000111100100'/>
<sequence spec='Sequence' taxon='I_3' totalcount='2' value='1011101101001011011011101111111011010010101111001101001010010000111001110111100100101110100001111110'/>
<sequence spec='Sequence' taxon='I_4' totalcount='2' value='0011110011100111000011100111010010100101111101001011001000010100111100111010111011101111010011111110'/>
<sequence spec='Sequence' taxon='J_1' totalcount='2' value='0010011111010011000011110101101010110110111110110110101010111111111110001010001000100110110111010101'/>
<sequence spec='Sequence' taxon='J_2' totalcount='2' value='1111100011011010000110110101101010110111111010110111101010110110001110001010111101111110010010001111'/>
<sequence spec='Sequence' taxon='J_3' totalcount='2' value='1111010111110011010010111001101101110110001001101010101110110111110100001000101010101110010010000001'/>
<sequence spec='Sequence' taxon='J_4' totalcount='2' value='1010010111111110110001000111111000110111011000000000000010111111100101001010101011111110100011010101'/>
<sequence spec='Sequence' taxon='K_1' totalcount='2' value='1110111001001111110010010111011010111000011010001110000111011001001000000001011010111000110111110010'/>
<sequence spec='Sequence' taxon='K_2' totalcount='2' value='0001111011110111011011010111111110111001101000111111000000010000000001001011010011111101010000000010'/>
<sequence spec='Sequence' taxon='K_3' totalcount='2' value='1110001101010111110111010111111110110001101011111111100101010011000001000011011110111111010010100110'/>
<sequence spec='Sequence' taxon='K_4' totalcount='2' value='1111001101010011011011111101111110010101011000000101010110011001100011100111101000010100000110010110'/>
<sequence spec='Sequence' taxon='L_1' totalcount='2' value='0110011111001101010010100010000010000001111000001010001110000001001100111100011001001110010111111111'/>
<sequence spec='Sequence' taxon='L_2' totalcount='2' value='1000011111010100110010110010011001011101001011011110110100010100000001011110010101000100100011111110'/>
<sequence spec='Sequence' taxon='L_3' totalcount='2' value='1010011101101110011010101110001010011001011011011110000101000001010001010010100100000100100110111100'/>
<sequence spec='Sequence' taxon='L_4' totalcount='2' value='1110000100100110010010100110011110110011111000001110110111001100000001110110100110110110010010111010'/>
<sequence spec='Sequence' taxon='M_1' totalcount='2' value='0110111001000010010011100111001010001000001011001110001110010000110001010001001110110101100011110000'/>
<sequence spec='Sequence' taxon='M_2' totalcount='2' value='1000011111010000000111100110101111110001101011100110110110100010111010001011110111101101100001110100'/>
<sequence spec='Sequence' taxon='M_3' totalcount='2' value='0001010111011111111011000011010010110001001001111110000110010010010000110101111010101101010000111010'/>
<sequence spec='Sequence' taxon='M_4' totalcount='2' value='1011001111010100110111101111010110101100101100001010010110100000110000111110110000111101000010101010'/>
<sequence spec='Sequence' taxon='N_1' totalcount='2' value='1001010010010111110101001111111111111111100000011110000000001011000000010010111111010100000110101010'/>
<sequence spec='Sequence' taxon='N_2' totalcount='2' value='1011010110110011000011000111110010001111011100011000110100000101110001001000101111110100001100010010'/>
<sequence spec='Sequence' taxon='N_3' totalcount='2' value='1001011100101111110110001111010011100111111000100010001100110011000011111010101100110011100101101001'/>
<sequence spec='Sequence' taxon='N_4' totalcount='2' value='1111000000001010100011001111111001101101010100010001001100001001010000011010001100101111010111100010'/>
<sequence spec='Sequence' taxon='O_1' totalcount='2' value='1110010110110110111110010101111111000001011100000101100100011011111111001000000100000100101011101101'/>
<sequence spec='Sequence' taxon='O_2' totalcount='2' value='1101100110110011011000010001010000100110001110001111100100010111111101010010100001000100001010111111'/>
<sequence spec='Sequence' taxon='O_3' totalcount='2' value='1111101100101101110010101100110001000011111111011101110101010011101101010000010100110100100011110010'/>
<sequence spec='Sequence' taxon='O_4' totalcount='2' value='0110111100111111111001010100100111100010001110001110110100010101110100000010111111000100100010011110'/>
<sequence spec='Sequence' taxon='P_1' totalcount='2' value='0001000110000001001001110111000010011111110100011111110100110010001100101001101100011100001000010111'/>
<sequence spec='Sequence' taxon='P_2' totalcount='2' value='1001000000100000011010110011001010111010111111010110110100011010111010101101101000110110001011001111'/>
<sequence spec='Sequence' taxon='P_3' totalcount='2' value='0111010111000001011011001001110000001010000101101101111000010111111000111100101001111111100000000010'/>
<sequence spec='Sequence' taxon='P_4' totalcount='2' value='1010100011110001010011100111010000011110000011011111100001001100111010111001101000011111111011100111'/>

    </data>
    
    <map name="Uniform" >beast.math.distributions.Uniform</map>
    <map name="Exponential" >beast.math.distributions.Exponential</map>
    <map name="LogNormal" >beast.math.distributions.LogNormalDistributionModel</map>
    <map name="Normal" >beast.math.distributions.Normal</map>
    <map name="Beta" >beast.math.distributions.Beta</map>
    <map name="Gamma" >beast.math.distributions.Gamma</map>
    <map name="LaplaceDistribution" >beast.math.distributions.LaplaceDistribution</map>
    <map name="prior" >beast.math.distributions.Prior</map>
    <map name="InverseGamma" >beast.math.distributions.InverseGamma</map>
    <map name="OneOnX" >beast.math.distributions.OneOnX</map>
    
    <run id="mcmc" spec="MCMC" chainLength="300000" preBurnin="0">
    
        <state id="state" spec="State" storeEvery="5000">
            <tree id="Tree.t:snapper" spec="beast.evolution.tree.Tree" name="stateNode" nodetype="snap.NodeData">
                <taxonset id="TaxonSet.snapper" spec="TaxonSet">
                    <alignment id="snapper.snapper" spec="snap.Data" dataType="integerdata">
                        <rawdata idref="snapper"/>
						<plate var="n" range="$(range=A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P)">
                    	    <taxonset id="$(n)" spec="TaxonSet">
                        	    <taxon id="$(n)_1" spec="Taxon"/>
                            	<taxon id="$(n)_2" spec="Taxon"/>
	                            <taxon id="$(n)_3" spec="Taxon"/>
    	                        <taxon id="$(n)_4" spec="Taxon"/>
        	                </taxonset>
    					</plate>
                    </alignment>
                </taxonset>
            </tree>
            <parameter id="snapperCoalescentRate.t:snapper" dimension="31" spec="parameter.RealParameter" lower="1.0E-10" name="stateNode" upper="10.0">1.0</parameter>

	        <parameter id="YuleSkylineBirthRateRate.t:snapper" spec="parameter.RealParameter" lower="0.0" name="stateNode">1.0</parameter>
            <parameter id="collapseWeight.t:Species" spec="parameter.RealParameter" lower="0.0" name="stateNode" upper="1.0">0.5</parameter>
        </state>
        
        <init id="RandomTree.t:snapper" spec="beast.evolution.tree.RandomTree" estimate="false" initial="@Tree.t:snapper" taxa="@snapper.snapper" rootHeight="0.5">
            <populationModel id="ConstantPopulation0.t:snapper" spec="ConstantPopulation">
                <parameter id="randomPopSize.t:snapper" spec="parameter.RealParameter" name="popSize">1.0</parameter>
            </populationModel>
        </init>
        
        <distribution id="posterior" spec="util.CompoundDistribution">
            <distribution id="prior" spec="util.CompoundDistribution">
                <prior id="SnapperCoalescentRatePrior.t:snapper" name="distribution" x="@snapperCoalescentRate.t:snapper">
                    <Gamma id="Gamma.2" name="distr" alpha="100" beta="0.01"/>
                </prior>
                
                <distribution id="YuleSkylineCollapse.t:Species" spec="speedemon.YuleSkylineCollapse" 
                	epsilon="1.0E-4" 
                	weight="@collapseWeight.t:Species"
 					linkedMean="true"
	            	birthRateShape="2"
    	        	birthRateRate="@YuleSkylineBirthRateRate.t:snapper"
	            	equalEpochs="true" tree="@Tree.t:snapper"    	        	
        	    	groupCount="2"/>

            	<prior id="YuleSkylineBirthRateRatePrior.t:snapper" name="distribution" x="@YuleSkylineBirthRateRate.t:snapper">
                	<LogNormal id="LogNormalDistributionModel.0" meanInRealSpace="true" name="distr" M="1.0" S="1.25"/>
	            </prior>

                <prior id="collapseWeight.prior" name="distribution" x="@collapseWeight.t:Species">
                    <Beta name="distr" alpha="1.0" beta="5.0"/>
                </prior>
                
                <prior id="treeHeightPrior.t:Species" name="distribution" x="@TreeHeight.t:snapper">
                    <Uniform id="Uniform.0" name="distr" lower="0.25"/>
                </prior>
                           
            </distribution>
            <distribution id="likelihood" spec="util.CompoundDistribution" useThreads="true">
                <distribution id="snapperTreeLikelihood.snapper" spec="snapper.SnapperTreeLikelihood" data="@snapper.snapper" pattern="coalescentRate" tree="@Tree.t:snapper">
                    <siteModel id="SnapperSiteModel.s:snapper" spec="SiteModel">
                        <substModel id="SnapperSubstModel.s:snapper" spec="snapper.SnapSubstitutionModel" coalescentRate="@snapperCoalescentRate.t:snapper">
                            <parameter id="snapperU.s:snapper" spec="parameter.RealParameter" estimate="false" lower="0.0" name="mutationRateU">1.0</parameter>
                            <parameter id="snapperV.s:snapper" spec="parameter.RealParameter" estimate="false" lower="0.0" name="mutationRateV">1.0</parameter>
                        </substModel>
                    </siteModel>
                    <branchRateModel id="StrictClock.c:snapper" spec="beast.evolution.branchratemodel.StrictClockModel">
                        <parameter id="clockRate.c:snapper" spec="parameter.RealParameter" estimate="false" name="clock.rate">1.0</parameter>
                    </branchRateModel>
                </distribution>
            </distribution>
        </distribution>
        
        <operator id="SnapperGammaMover.t:snapper" spec="snap.operators.GammaMover" coalescenceRate="@snapperCoalescentRate.t:snapper" scale="0.75" weight="10.0"/>
        <operator id="SnapperRateMixer.t:snapper" spec="snap.operators.RateMixer" coalescenceRate="@snapperCoalescentRate.t:snapper" scaleFactors="0.25" tree="@Tree.t:snapper" weight="10.0"/>

        <operator id="YuleModelTreeScaler.t:snapper" spec="ScaleOperator" scaleFactor="0.5" tree="@Tree.t:snapper" weight="3.0"/>
        <operator id="YuleModelTreeRootScaler.t:snapper" spec="ScaleOperator" rootOnly="true" scaleFactor="0.5" tree="@Tree.t:snapper" weight="3.0"/>
        <operator id="YuleModelUniformOperator.t:snapper" spec="Uniform" tree="@Tree.t:snapper" weight="30.0"/>
        <operator id="YuleModelSubtreeSlide.t:snapper" spec="SubtreeSlide" tree="@Tree.t:snapper" weight="15.0"/>
        <operator id="YuleModelNarrow.t:snapper" spec="Exchange" tree="@Tree.t:snapper" weight="15.0"/>
        <operator id="YuleModelWide.t:snapper" spec="Exchange" isNarrow="false" tree="@Tree.t:snapper" weight="3.0"/>
        <operator id="YuleModelWilsonBalding.t:snapper" spec="WilsonBalding" tree="@Tree.t:snapper" weight="3.0"/>
        
        
        <operator id="bdcCollapseWeightScaler100.t:Species" spec="ScaleOperator" optimise="false" parameter="@collapseWeight.t:Species" scaleFactor="0.1" weight="0.2"/>
        <operator id="bdcCollapseWeightRW0001.t:Species" spec="RealRandomWalkOperator" parameter="@collapseWeight.t:Species" weight="0.3" windowSize="1.0E-4"/>
        <operator id="updown.999.all.Species" spec="UpDownOperator" optimise="false" scaleFactor="0.999" weight="2.0">
            <down idref="Tree.t:snapper"/>
        </operator>
 
        <operator id="YuleSkylineBirthRateRateScaler.s:snapper" spec="ScaleOperator" parameter="@YuleSkylineBirthRateRate.t:snapper" scaleFactor="0.5" weight="0.1"/>

        <logger id="tracelog" spec="Logger" fileName="$(filebase).log" logEvery="100" model="@posterior" sanitiseHeaders="true" sort="smart">
            <log idref="posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
            <log id="TreeHeight.t:snapper" spec="beast.evolution.tree.TreeHeightLogger" tree="@Tree.t:snapper"/>
	        <log idref="YuleSkylineBirthRateRate.t:snapper"/>
            <log idref="snapperCoalescentRate.t:snapper"/>

            <log idref="collapseWeight.t:Species"/>

            <log idref="YuleSkylineCollapse.t:Species"/>

        </logger>
        
        <logger id="screenlog" spec="Logger" logEvery="10000">
            <log idref="posterior"/>
            <log idref="likelihood"/>
            <log idref="prior"/>
            <log idref="collapseWeight.t:Species"/>
        </logger>
        
        <logger id="treelog.t:snapper" spec="Logger" fileName="$(filebase).trees" logEvery="1000" mode="tree">
            <log id="TreeWithMetaDataLogger.t:snapper" spec="beast.evolution.tree.TreeWithMetaDataLogger" tree="@Tree.t:snapper">
            	<!--metadata="@snapperCoalescentRate.t:snapper"-->
            	<metadata id="theta" spec="snap.ThetaLogger" coalescenceRate="@snapperCoalescentRate.t:snapper"/>
            	</log>
        </logger>
    </run>
    
</beast>
